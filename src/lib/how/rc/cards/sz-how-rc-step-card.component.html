<h3 class="title hide-on-collapsed hide-on-group-collapsed hide-on-group-interim">
    <mat-icon *ngIf="canExpand && hasChildren"  class="toggle-child-expansion-icon" (click)="toggleExpansion()" fontIcon="play_circle"></mat-icon>
    <mat-icon *ngIf="canExpand && !hasChildren" class="toggle-expansion-icon"       (click)="toggleExpansion()" fontIcon="arrow_right"></mat-icon>
    <div class="title-text">{{title}}</div>
    <mat-icon *ngIf="isGroupMember && isUnpinned" class="pin-icon" (click)="pinStep()" fontIcon="push_pin"></mat-icon>
    <mat-icon *ngIf="canBeGrouped && !isUnpinned" class="unpin-icon" (click)="unpinStep()" fontIcon="adjust"></mat-icon>
</h3>
<h3 class="title hide-on-expanded hide-on-group-collapsed hide-on-group-interim">
    <mat-icon *ngIf="canExpand && hasChildren"  class="toggle-child-expansion-icon" (click)="toggleExpansion()" fontIcon="play_circle"></mat-icon>
    <mat-icon *ngIf="canExpand && !hasChildren" class="toggle-expansion-icon"       (click)="toggleExpansion()" fontIcon="arrow_right"></mat-icon>
    <div class="title-text">
        {{title}}<span *ngIf="isInterimEntity" class="datasources"> [ <span class="datasources-list">{{dataSourcesAsString}}</span> ]</span>
        <span class="title-token" *ngIf="isCreateEntity"> from </span>
        <div *ngIf="isCreateEntity" class="title-from" [innerHTML]="from"></div>
    </div>
</h3>
<!-- hasChildren: {{hasChildren}} | canExpand: {{canExpand}} -->
<h3 *ngIf="groupTitle !== undefined" class="title-group">
    <mat-icon *ngIf="canExpand && hasChildren"  class="toggle-group-expansion-icon" (click)="toggleGroupExpansion(groupId)" fontIcon="play_circle"></mat-icon>
    <mat-icon *ngIf="canExpand && !hasChildren" class="toggle-expansion-icon"       (click)="toggleGroupExpansion(groupId)" fontIcon="arrow_right"></mat-icon>
    <div class="title-text">{{groupTitle}}<span *ngIf="dataSourcesAsString" class="datasources"> [ <span class="datasources-list">{{dataSourcesAsString}}</span> ]</span></div>
</h3>
<div class="columns hide-on-collapsed hide-on-group-collapsed">
    <div class="column info-block">
        <div class="info-line" *ngFor="let line of description; let l = index">
            <span [innerHTML]="line"></span>
            <mat-icon *ngIf="l == 0" (click)="openVirtualEntityDialog($event)" class="info-icon" aria-hidden="false" aria-label="Show Virtual Entity Details" fontIcon="info"></mat-icon>
        </div>
        <!--<div>Forms <span class="emphasis">Virtual Entity V123-S12</span></div>
        <div>On <span class="emphasis">NAME+ADDRESS</span></div>
        <div>Using <span class="emphasis">Principle 162 (CNAME_CFF)</span></div>-->
    </div>
    <div class="column data-table horizontal">
        <div class="pre-head">
            <div class="cell"></div>
            <div class="cell">{{candidateVirtualEntity?.virtualEntityId}}</div>
            <div class="cell">Score</div>
            <div class="cell">{{inboundVirtualEntity?.virtualEntityId}}</div>
        </div>
        <div class="head">
            <div class="cell column-1">Sources ({{sourcesCount}}) / Records ({{recordsCount}})</div>
            <div class="cell column-2">
                {{getSourcesAndRecordsForEntity(candidateVirtualEntity)}}
            </div>
            <div class="cell column-3">N/A</div>
            <div class="cell column-4">
                {{getSourcesAndRecordsForEntity(inboundVirtualEntity)}}
            </div>
        </div>
        <div class="body">
            <div class="row" *ngFor="let feature of dataRows; let i = index">
                <div class="cell column-1">{{feature.featureType}}</div>
                <div class="cell column-2">{{feature.candidateFeature?.featureValue}}</div>
                <div class="cell column-3">{{feature.score}}</div>
                <div class="cell column-4">{{feature.inboundFeature?.featureValue}}</div>
            </div>
        </div>
    </div>
</div>
<!--<ul *ngIf="this.resolvedVirtualEntity && this.isInterimEntity" class="debug">
    <li>this.resolvedVirtualEntity: {{this.resolvedVirtualEntity.virtualEntityId}}</li>
    <li>this.isInterimEntity: {{this.isInterimEntity}}</li>
</ul>-->
