<sz-how-rc-nav
    [stepsByVirtualId]="resolutionStepsByVirtualId"
    [finalVirtualEntities]="finalCardsData"
    [virtualEntitiesById]="virtualEntitiesById"
    [finalEntityId]="entityId"
    *ngIf="showNavigation"
></sz-how-rc-nav>
<div class="main">
    <button (click)="getDefaultResolutionStepGroups()">get default step groups list</button>

    <ul class="step-list">
        <li class="top-level">
            <sz-how-rc-final-entity-card *ngFor="let vCardData of finalCardsData"
                [data]="vCardData"
                [featureOrder]="orderedFeatures"
                [virtualEntitiesById]="virtualEntitiesById"></sz-how-rc-final-entity-card>
        </li>
        <li *ngFor="let step of resolutionStepsWithGroups; let rsInd=index"
            [ngSwitch]="isResolutionStep(step)">
            <ng-template [ngSwitchCase]="false">
                <sz-how-rc-step-group
                    [data]="cooerceToStepGroup(step)"
                    [featureOrder]="orderedFeatures" 
                    [virtualEntitiesById]="virtualEntitiesById"></sz-how-rc-step-group>
            </ng-template>
            <ng-template [ngSwitchCase]="true">
                <sz-how-rc-step *ngIf="isResolutionStep(step)"
                [attr.step-index]="rsInd"
                [attr.step-number]="cooerceToStep(step).stepNumber"
                [attr.virtual-id]="cooerceToStep(step).resolvedVirtualEntityId"
                [data]="cooerceToStep(step)" 
                [featureOrder]="orderedFeatures" 
                [virtualEntitiesById]="virtualEntitiesById"></sz-how-rc-step>
            </ng-template>
            <ng-template [ngSwitchCase]="false">
                <div class="stack-control">
                    <mat-icon 
                    aria-hidden="false" 
                    aria-label="Example home icon" 
                    fontIcon="add_circle" (click)="toggleCollapsedState(cooerceToStepGroup(step))"></mat-icon>
                </div>
            </ng-template>
        </li>
    </ul>
</div>